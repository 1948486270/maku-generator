import{d as L,r as y,a as k,b as a,o as V,c as A,w as t,e,l as U,h as g,E as w,k as N,u as _,m as R}from"./index.a55057d0.js";import{b as x,c as z,d as O}from"./datasource.b5888be9.js";import{u as H}from"./index.cbafa6c9.js";const M=g("\u53D6\u6D88"),P=g("\u786E\u5B9A"),K=L({__name:"add-or-update",emits:["refreshDataList"],setup($,{expose:n,emit:D}){const m=y(!1),f=y(),u=k({id:"",dbType:"",connName:"",connUrl:"",username:"",password:""}),E=r=>{m.value=!0,u.id="",f.value&&f.value.resetFields(),r&&F(r)},F=r=>{x(r).then(l=>{Object.assign(u,l.data)})},B=y({dbType:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],connName:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],connUrl:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],username:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],password:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),v=()=>{f.value.validate(r=>{if(!r)return!1;z(u).then(()=>{w.success({message:"\u64CD\u4F5C\u6210\u529F",duration:500,onClose:()=>{m.value=!1,D("refreshDataList")}})})})};return n({init:E}),(r,l)=>{const b=a("el-input"),d=a("el-form-item"),s=a("el-option"),S=a("el-select"),c=a("el-form"),C=a("el-button"),p=a("el-dialog");return V(),A(p,{modelValue:m.value,"onUpdate:modelValue":l[8]||(l[8]=o=>m.value=o),title:u.id?"\u4FEE\u6539":"\u65B0\u589E","close-on-click-modal":!1},{footer:t(()=>[e(C,{onClick:l[6]||(l[6]=o=>m.value=!1)},{default:t(()=>[M]),_:1}),e(C,{type:"primary",onClick:l[7]||(l[7]=o=>v())},{default:t(()=>[P]),_:1})]),default:t(()=>[e(c,{ref_key:"dataFormRef",ref:f,model:u,rules:B.value,"label-width":"120px",onKeyup:l[5]||(l[5]=U(o=>v(),["enter"]))},{default:t(()=>[e(d,{label:"\u8FDE\u63A5\u540D",prop:"connName"},{default:t(()=>[e(b,{modelValue:u.connName,"onUpdate:modelValue":l[0]||(l[0]=o=>u.connName=o),placeholder:"\u8FDE\u63A5\u540D"},null,8,["modelValue"])]),_:1}),e(d,{prop:"dbType",label:"\u6570\u636E\u5E93\u7C7B\u578B"},{default:t(()=>[e(S,{modelValue:u.dbType,"onUpdate:modelValue":l[1]||(l[1]=o=>u.dbType=o),clearable:"",placeholder:"\u6570\u636E\u5E93\u7C7B\u578B",style:{width:"100%"}},{default:t(()=>[e(s,{value:"MySQL",label:"MySQL"}),e(s,{value:"Oracle",label:"Oracle"}),e(s,{value:"PostgreSQL",label:"PostgreSQL"}),e(s,{value:"SQLServer",label:"SQLServer"}),e(s,{value:"DM",label:"\u8FBE\u68A68"}),e(s,{value:"Clickhouse",label:"Clickhouse"})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"\u6570\u636E\u5E93URL",prop:"connUrl"},{default:t(()=>[e(b,{modelValue:u.connUrl,"onUpdate:modelValue":l[2]||(l[2]=o=>u.connUrl=o),placeholder:"\u6570\u636E\u5E93URL"},null,8,["modelValue"])]),_:1}),e(d,{label:"\u7528\u6237\u540D",prop:"username"},{default:t(()=>[e(b,{modelValue:u.username,"onUpdate:modelValue":l[3]||(l[3]=o=>u.username=o),placeholder:"\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1}),e(d,{label:"\u5BC6\u7801",prop:"password"},{default:t(()=>[e(b,{modelValue:u.password,"onUpdate:modelValue":l[4]||(l[4]=o=>u.password=o),placeholder:"\u5BC6\u7801"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),j=g("\u67E5\u8BE2"),G=g("\u65B0\u589E"),I=g("\u5220\u9664"),J=g("\u6D4B\u8BD5"),W=g("\u7F16\u8F91"),X=g("\u5220\u9664"),le=L({__name:"index",setup($){const n=k({dataListUrl:"/gen/datasource/page",deleteUrl:"/gen/datasource",queryForm:{connName:"",dbType:""}}),D=r=>{O(r).then(l=>{w.success(l.data)})},m=y(),f=r=>{m.value.init(r)},{getDataList:u,selectionChangeHandle:E,sizeChangeHandle:F,currentChangeHandle:B,deleteBatchHandle:v}=H(n);return(r,l)=>{const b=a("el-input"),d=a("el-form-item"),s=a("el-option"),S=a("el-select"),c=a("el-button"),C=a("el-form"),p=a("el-table-column"),o=a("el-table"),Q=a("el-pagination"),T=a("el-card"),q=N("loading");return V(),A(T,null,{default:t(()=>[e(C,{inline:!0,model:n.queryForm,onKeyup:l[5]||(l[5]=U(i=>_(u)(),["enter"]))},{default:t(()=>[e(d,null,{default:t(()=>[e(b,{modelValue:n.queryForm.connName,"onUpdate:modelValue":l[0]||(l[0]=i=>n.queryForm.connName=i),placeholder:"\u8FDE\u63A5\u540D"},null,8,["modelValue"])]),_:1}),e(d,{prop:"dbType"},{default:t(()=>[e(S,{modelValue:n.queryForm.dbType,"onUpdate:modelValue":l[1]||(l[1]=i=>n.queryForm.dbType=i),clearable:"",placeholder:"\u6570\u636E\u5E93\u7C7B\u578B"},{default:t(()=>[e(s,{value:"MySQL",label:"MySQL"}),e(s,{value:"Oracle",label:"Oracle"}),e(s,{value:"PostgreSQL",label:"PostgreSQL"}),e(s,{value:"SQLServer",label:"SQLServer"}),e(s,{value:"DM",label:"\u8FBE\u68A68"})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:t(()=>[e(c,{onClick:l[2]||(l[2]=i=>_(u)())},{default:t(()=>[j]),_:1})]),_:1}),e(d,null,{default:t(()=>[e(c,{type:"primary",onClick:l[3]||(l[3]=i=>f())},{default:t(()=>[G]),_:1})]),_:1}),e(d,null,{default:t(()=>[e(c,{type:"danger",onClick:l[4]||(l[4]=i=>_(v)())},{default:t(()=>[I]),_:1})]),_:1})]),_:1},8,["model"]),R((V(),A(o,{data:n.dataList,border:"",style:{width:"100%"},onSelectionChange:_(E)},{default:t(()=>[e(p,{type:"selection","header-align":"center",align:"center",width:"50"}),e(p,{prop:"connName",label:"\u8FDE\u63A5\u540D","header-align":"center",align:"center"}),e(p,{prop:"dbType",label:"\u6570\u636E\u5E93\u7C7B\u578B","header-align":"center",align:"center"}),e(p,{prop:"connUrl",label:"\u6570\u636E\u5E93URL","show-overflow-tooltip":"","header-align":"center",align:"center"}),e(p,{prop:"username",label:"\u7528\u6237\u540D","header-align":"center",align:"center"}),e(p,{prop:"password",label:"\u5BC6\u7801","header-align":"center",align:"center"}),e(p,{label:"\u64CD\u4F5C",fixed:"right","header-align":"center",align:"center",width:"170"},{default:t(i=>[e(c,{type:"primary",link:"",onClick:h=>D(i.row.id)},{default:t(()=>[J]),_:2},1032,["onClick"]),e(c,{type:"primary",link:"",onClick:h=>f(i.row.id)},{default:t(()=>[W]),_:2},1032,["onClick"]),e(c,{type:"primary",link:"",onClick:h=>_(v)(i.row.id)},{default:t(()=>[X]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[q,n.dataListLoading]]),e(Q,{"current-page":n.page,"page-sizes":n.pageSizes,"page-size":n.limit,total:n.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:_(F),onCurrentChange:_(B)},null,8,["current-page","page-sizes","page-size","total","onSizeChange","onCurrentChange"]),e(K,{ref_key:"addOrUpdateRef",ref:m,onRefreshDataList:_(u)},null,8,["onRefreshDataList"])]),_:1})}}});export{le as default};
