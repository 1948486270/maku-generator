import{d as A,r as D,a as U,b as n,o as V,c as h,w as t,e,k,h as g,E as w,j as T,f as q,u as _,l as x}from"./index.64197d12.js";import{a as N,b as R,c as O}from"./datasource.c01bf7e3.js";import{u as H}from"./index.fe84a65c.js";const M=g("\u53D6\u6D88"),P=g("\u786E\u5B9A"),j=A({__name:"add-or-update",emits:["refreshDataList"],setup($,{expose:o,emit:E}){const m=D(!1),f=D(),a=U({id:"",dbType:"",connName:"",connUrl:"",username:"",password:""}),y=r=>{m.value=!0,a.id="",f.value&&f.value.resetFields(),r&&F(r)},F=r=>{N(r).then(l=>{Object.assign(a,l.data)})},S=D({dbType:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],connName:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],connUrl:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],username:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],password:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),C=()=>{f.value.validate(r=>{if(!r)return!1;R(a).then(()=>{w.success({message:"\u64CD\u4F5C\u6210\u529F",duration:500,onClose:()=>{m.value=!1,E("refreshDataList")}})})})};return o({init:y}),(r,l)=>{const b=n("el-input"),s=n("el-form-item"),i=n("el-option"),B=n("el-select"),c=n("el-form"),v=n("el-button"),p=n("el-dialog");return V(),h(p,{modelValue:m.value,"onUpdate:modelValue":l[8]||(l[8]=u=>m.value=u),title:a.id?"\u4FEE\u6539":"\u65B0\u589E","close-on-click-modal":!1},{footer:t(()=>[e(v,{onClick:l[6]||(l[6]=u=>m.value=!1)},{default:t(()=>[M]),_:1}),e(v,{type:"primary",onClick:l[7]||(l[7]=u=>C())},{default:t(()=>[P]),_:1})]),default:t(()=>[e(c,{ref_key:"dataFormRef",ref:f,model:a,rules:S.value,"label-width":"120px",onKeyup:l[5]||(l[5]=k(u=>C(),["enter"]))},{default:t(()=>[e(s,{label:"\u8FDE\u63A5\u540D",prop:"connName"},{default:t(()=>[e(b,{modelValue:a.connName,"onUpdate:modelValue":l[0]||(l[0]=u=>a.connName=u),placeholder:"\u8FDE\u63A5\u540D"},null,8,["modelValue"])]),_:1}),e(s,{prop:"dbType",label:"\u6570\u636E\u5E93\u7C7B\u578B"},{default:t(()=>[e(B,{modelValue:a.dbType,"onUpdate:modelValue":l[1]||(l[1]=u=>a.dbType=u),clearable:"",placeholder:"\u6570\u636E\u5E93\u7C7B\u578B",class:"w-percent-100"},{default:t(()=>[e(i,{value:"SQLServer",label:"SQLServer"}),e(i,{value:"MySQL",label:"MySQL"}),e(i,{value:"Oracle",label:"Oracle"}),e(i,{value:"PostgreSQL",label:"PostgreSQL"})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"\u6570\u636E\u5E93URL",prop:"connUrl"},{default:t(()=>[e(b,{modelValue:a.connUrl,"onUpdate:modelValue":l[2]||(l[2]=u=>a.connUrl=u),placeholder:"\u6570\u636E\u5E93URL"},null,8,["modelValue"])]),_:1}),e(s,{label:"\u7528\u6237\u540D",prop:"username"},{default:t(()=>[e(b,{modelValue:a.username,"onUpdate:modelValue":l[3]||(l[3]=u=>a.username=u),placeholder:"\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1}),e(s,{label:"\u5BC6\u7801",prop:"password"},{default:t(()=>[e(b,{modelValue:a.password,"onUpdate:modelValue":l[4]||(l[4]=u=>a.password=u),placeholder:"\u5BC6\u7801"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),K=g("\u67E5\u8BE2"),G=g("\u65B0\u589E"),I=g("\u5220\u9664"),J=g("\u8FDE\u63A5\u6D4B\u8BD5"),W=g("\u7F16\u8F91"),X=g("\u5220\u9664"),Y=A({name:"DataSource"}),te=A({...Y,setup($){const o=U({dataListUrl:"/gen/datasource/page",deleteUrl:"/gen/datasource",queryForm:{connName:"",dbType:""}}),E=r=>{O(r).then(l=>{w.success(l.data)})},m=D(),f=r=>{m.value.init(r)},{getDataList:a,selectionChangeHandle:y,sizeChangeHandle:F,currentChangeHandle:S,deleteBatchHandle:C}=H(o);return(r,l)=>{const b=n("el-input"),s=n("el-form-item"),i=n("el-option"),B=n("el-select"),c=n("el-button"),v=n("el-form"),p=n("el-table-column"),u=n("el-table"),z=n("el-pagination"),Q=T("loading");return V(),q("div",null,[e(v,{inline:!0,model:o.queryForm,onKeyup:l[5]||(l[5]=k(d=>_(a)(),["enter"]))},{default:t(()=>[e(s,null,{default:t(()=>[e(b,{modelValue:o.queryForm.connName,"onUpdate:modelValue":l[0]||(l[0]=d=>o.queryForm.connName=d),placeholder:"\u8FDE\u63A5\u540D",clearable:""},null,8,["modelValue"])]),_:1}),e(s,{prop:"dbType"},{default:t(()=>[e(B,{modelValue:o.queryForm.dbType,"onUpdate:modelValue":l[1]||(l[1]=d=>o.queryForm.dbType=d),clearable:"",placeholder:"\u6570\u636E\u5E93\u7C7B\u578B"},{default:t(()=>[e(i,{value:"SQLServer",label:"SQLServer"}),e(i,{value:"MySQL",label:"MySQL"}),e(i,{value:"Oracle",label:"Oracle"}),e(i,{value:"PostgreSQL",label:"PostgreSQL"})]),_:1},8,["modelValue"])]),_:1}),e(s,null,{default:t(()=>[e(c,{onClick:l[2]||(l[2]=d=>_(a)())},{default:t(()=>[K]),_:1})]),_:1}),e(s,null,{default:t(()=>[e(c,{type:"primary",onClick:l[3]||(l[3]=d=>f())},{default:t(()=>[G]),_:1})]),_:1}),e(s,null,{default:t(()=>[e(c,{type:"danger",onClick:l[4]||(l[4]=d=>_(C)())},{default:t(()=>[I]),_:1})]),_:1})]),_:1},8,["model"]),x((V(),h(u,{data:o.dataList,border:"",style:{width:"100%"},onSelectionChange:_(y)},{default:t(()=>[e(p,{type:"selection","header-align":"center",align:"center",width:"50"}),e(p,{prop:"connName",label:"\u8FDE\u63A5\u540D","header-align":"center",align:"center"}),e(p,{prop:"dbType",label:"\u6570\u636E\u5E93\u7C7B\u578B","header-align":"center",align:"center"}),e(p,{prop:"connUrl",label:"\u6570\u636E\u5E93URL","header-align":"center",align:"center"}),e(p,{prop:"username",label:"\u7528\u6237\u540D","header-align":"center",align:"center"}),e(p,{prop:"password",label:"\u5BC6\u7801","header-align":"center",align:"center"}),e(p,{label:"\u64CD\u4F5C",fixed:"right","header-align":"center",align:"center",width:"150"},{default:t(d=>[e(c,{type:"text",size:"small",onClick:L=>E(d.row.id)},{default:t(()=>[J]),_:2},1032,["onClick"]),e(c,{type:"text",size:"small",onClick:L=>f(d.row.id)},{default:t(()=>[W]),_:2},1032,["onClick"]),e(c,{type:"text",size:"small",onClick:L=>_(C)(d.row.id)},{default:t(()=>[X]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[Q,o.dataListLoading]]),e(z,{"current-page":o.page,"page-sizes":o.pageSizes,"page-size":o.limit,total:o.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:_(F),onCurrentChange:_(S)},null,8,["current-page","page-sizes","page-size","total","onSizeChange","onCurrentChange"]),e(j,{ref_key:"addOrUpdateRef",ref:m,onRefreshDataList:_(a)},null,8,["onRefreshDataList"])])}}});export{te as default};
