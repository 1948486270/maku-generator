import{d as L,r as y,a as h,b as o,o as V,c as U,w as t,e,l as k,h as g,E as w,k as q,f as N,u as _,m as R}from"./index.38de24dd.js";import{b as z,c as x,d as O}from"./datasource.ad75a42c.js";import{u as H}from"./index.a604d30d.js";const M=g("\u53D6\u6D88"),P=g("\u786E\u5B9A"),K=L({__name:"add-or-update",emits:["refreshDataList"],setup($,{expose:n,emit:D}){const m=y(!1),f=y(),a=h({id:"",dbType:"",connName:"",connUrl:"",username:"",password:""}),E=r=>{m.value=!0,a.id="",f.value&&f.value.resetFields(),r&&F(r)},F=r=>{z(r).then(l=>{Object.assign(a,l.data)})},S=y({dbType:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],connName:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],connUrl:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],username:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],password:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),v=()=>{f.value.validate(r=>{if(!r)return!1;x(a).then(()=>{w.success({message:"\u64CD\u4F5C\u6210\u529F",duration:500,onClose:()=>{m.value=!1,D("refreshDataList")}})})})};return n({init:E}),(r,l)=>{const b=o("el-input"),s=o("el-form-item"),i=o("el-option"),B=o("el-select"),c=o("el-form"),C=o("el-button"),p=o("el-dialog");return V(),U(p,{modelValue:m.value,"onUpdate:modelValue":l[8]||(l[8]=u=>m.value=u),title:a.id?"\u4FEE\u6539":"\u65B0\u589E","close-on-click-modal":!1},{footer:t(()=>[e(C,{onClick:l[6]||(l[6]=u=>m.value=!1)},{default:t(()=>[M]),_:1}),e(C,{type:"primary",onClick:l[7]||(l[7]=u=>v())},{default:t(()=>[P]),_:1})]),default:t(()=>[e(c,{ref_key:"dataFormRef",ref:f,model:a,rules:S.value,"label-width":"120px",onKeyup:l[5]||(l[5]=k(u=>v(),["enter"]))},{default:t(()=>[e(s,{label:"\u8FDE\u63A5\u540D",prop:"connName"},{default:t(()=>[e(b,{modelValue:a.connName,"onUpdate:modelValue":l[0]||(l[0]=u=>a.connName=u),placeholder:"\u8FDE\u63A5\u540D"},null,8,["modelValue"])]),_:1}),e(s,{prop:"dbType",label:"\u6570\u636E\u5E93\u7C7B\u578B"},{default:t(()=>[e(B,{modelValue:a.dbType,"onUpdate:modelValue":l[1]||(l[1]=u=>a.dbType=u),clearable:"",placeholder:"\u6570\u636E\u5E93\u7C7B\u578B",style:{width:"100%"}},{default:t(()=>[e(i,{value:"MySQL",label:"MySQL"}),e(i,{value:"Oracle",label:"Oracle"}),e(i,{value:"PostgreSQL",label:"PostgreSQL"}),e(i,{value:"SQLServer",label:"SQLServer"})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"\u6570\u636E\u5E93URL",prop:"connUrl"},{default:t(()=>[e(b,{modelValue:a.connUrl,"onUpdate:modelValue":l[2]||(l[2]=u=>a.connUrl=u),placeholder:"\u6570\u636E\u5E93URL"},null,8,["modelValue"])]),_:1}),e(s,{label:"\u7528\u6237\u540D",prop:"username"},{default:t(()=>[e(b,{modelValue:a.username,"onUpdate:modelValue":l[3]||(l[3]=u=>a.username=u),placeholder:"\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1}),e(s,{label:"\u5BC6\u7801",prop:"password"},{default:t(()=>[e(b,{modelValue:a.password,"onUpdate:modelValue":l[4]||(l[4]=u=>a.password=u),placeholder:"\u5BC6\u7801"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),j=g("\u67E5\u8BE2"),G=g("\u65B0\u589E"),I=g("\u5220\u9664"),J=g("\u6D4B\u8BD5"),W=g("\u7F16\u8F91"),X=g("\u5220\u9664"),Y=L({name:"DataSource"}),te=L({...Y,setup($){const n=h({dataListUrl:"/gen/datasource/page",deleteUrl:"/gen/datasource",queryForm:{connName:"",dbType:""}}),D=r=>{O(r).then(l=>{w.success(l.data)})},m=y(),f=r=>{m.value.init(r)},{getDataList:a,selectionChangeHandle:E,sizeChangeHandle:F,currentChangeHandle:S,deleteBatchHandle:v}=H(n);return(r,l)=>{const b=o("el-input"),s=o("el-form-item"),i=o("el-option"),B=o("el-select"),c=o("el-button"),C=o("el-form"),p=o("el-table-column"),u=o("el-table"),Q=o("el-pagination"),T=q("loading");return V(),N("div",null,[e(C,{inline:!0,model:n.queryForm,onKeyup:l[5]||(l[5]=k(d=>_(a)(),["enter"]))},{default:t(()=>[e(s,null,{default:t(()=>[e(b,{modelValue:n.queryForm.connName,"onUpdate:modelValue":l[0]||(l[0]=d=>n.queryForm.connName=d),placeholder:"\u8FDE\u63A5\u540D"},null,8,["modelValue"])]),_:1}),e(s,{prop:"dbType"},{default:t(()=>[e(B,{modelValue:n.queryForm.dbType,"onUpdate:modelValue":l[1]||(l[1]=d=>n.queryForm.dbType=d),clearable:"",placeholder:"\u6570\u636E\u5E93\u7C7B\u578B"},{default:t(()=>[e(i,{value:"MySQL",label:"MySQL"}),e(i,{value:"Oracle",label:"Oracle"}),e(i,{value:"PostgreSQL",label:"PostgreSQL"}),e(i,{value:"SQLServer",label:"SQLServer"})]),_:1},8,["modelValue"])]),_:1}),e(s,null,{default:t(()=>[e(c,{onClick:l[2]||(l[2]=d=>_(a)())},{default:t(()=>[j]),_:1})]),_:1}),e(s,null,{default:t(()=>[e(c,{type:"primary",onClick:l[3]||(l[3]=d=>f())},{default:t(()=>[G]),_:1})]),_:1}),e(s,null,{default:t(()=>[e(c,{type:"danger",onClick:l[4]||(l[4]=d=>_(v)())},{default:t(()=>[I]),_:1})]),_:1})]),_:1},8,["model"]),R((V(),U(u,{data:n.dataList,border:"",style:{width:"100%"},onSelectionChange:_(E)},{default:t(()=>[e(p,{type:"selection","header-align":"center",align:"center",width:"50"}),e(p,{prop:"connName",label:"\u8FDE\u63A5\u540D","header-align":"center",align:"center"}),e(p,{prop:"dbType",label:"\u6570\u636E\u5E93\u7C7B\u578B","header-align":"center",align:"center"}),e(p,{prop:"connUrl",label:"\u6570\u636E\u5E93URL","show-overflow-tooltip":"","header-align":"center",align:"center"}),e(p,{prop:"username",label:"\u7528\u6237\u540D","header-align":"center",align:"center"}),e(p,{prop:"password",label:"\u5BC6\u7801","header-align":"center",align:"center"}),e(p,{label:"\u64CD\u4F5C",fixed:"right","header-align":"center",align:"center",width:"170"},{default:t(d=>[e(c,{type:"primary",link:"",onClick:A=>D(d.row.id)},{default:t(()=>[J]),_:2},1032,["onClick"]),e(c,{type:"primary",link:"",onClick:A=>f(d.row.id)},{default:t(()=>[W]),_:2},1032,["onClick"]),e(c,{type:"primary",link:"",onClick:A=>_(v)(d.row.id)},{default:t(()=>[X]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[T,n.dataListLoading]]),e(Q,{"current-page":n.page,"page-sizes":n.pageSizes,"page-size":n.limit,total:n.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:_(F),onCurrentChange:_(S)},null,8,["current-page","page-sizes","page-size","total","onSizeChange","onCurrentChange"]),e(K,{ref_key:"addOrUpdateRef",ref:m,onRefreshDataList:_(a)},null,8,["onRefreshDataList"])])}}});export{te as default};
